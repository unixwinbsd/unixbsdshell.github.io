<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>PFSense with Internal DNS - Setup Remote Unbound DNS Resolver For LAN Network - UnixBSDShell</title>
<meta name="description" content="To carry out its duties, the DNS server requires a client program called a resolver to connect each user’s computer to the DNS server. The DNS resolver searches the host address in the HOSTS file">


  <meta name="author" content="UnixBSDShell's Blog">
  
  <meta property="article:author" content="UnixBSDShell's Blog">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="UnixBSDShell">
<meta property="og:title" content="PFSense with Internal DNS - Setup Remote Unbound DNS Resolver For LAN Network">
<meta property="og:url" content="https://unixwinbsd.site/freebsd/pfsense-with-internal-dns-unbound/">


  <meta property="og:description" content="To carry out its duties, the DNS server requires a client program called a resolver to connect each user’s computer to the DNS server. The DNS resolver searches the host address in the HOSTS file">





  <meta name="twitter:site" content="@iwanset96143401">
  <meta name="twitter:title" content="PFSense with Internal DNS - Setup Remote Unbound DNS Resolver For LAN Network">
  <meta name="twitter:description" content="To carry out its duties, the DNS server requires a client program called a resolver to connect each user’s computer to the DNS server. The DNS resolver searches the host address in the HOSTS file">
  <meta name="twitter:url" content="https://unixwinbsd.site/freebsd/pfsense-with-internal-dns-unbound/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2025-07-26T15:32:21+03:00">





  

  


<link rel="canonical" href="https://unixwinbsd.site/freebsd/pfsense-with-internal-dns-unbound/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "UnixBSDShell Blog",
      "url": "https://unixwinbsd.site/"
    
  }
</script>


  <meta name="google-site-verification" content="googledc9be5e5382da4fd" />


  <meta name="msvalidate.01" content="BCDF1444D895EBA62C6422C90DF8EA1C">



  <meta name="yandex-verification" content="69d778baa1dbd371">


<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="UnixBSDShell Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- <script data-ad-client="ca-pub-8799681346916578" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->

<!-- end custom head snippets -->


<meta name="google-site-verification" content="RT2u0cL3NCPK3ydcuewM50F8hvklo6JxBJGxu0zypiw" />
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js', 'ym');

    ym(95812963, 'init', {webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/95812963" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GT-TNPXBWRM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GT-TNPXBWRM');
</script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RWLWYNFRW0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RWLWYNFRW0');
</script>

<script>
gtag('set', 'user_data', {
"email": datainchi@gmail.com,
"phone_number": +6281289065249,
"address": {
"first_name": Iwan,
"last_name": Setiawan,
"street": Kp. Warung Bongkok RT. 002/01,
"city": Kabupaten Bekasi,
"region": Jawa Barat,
"postal_code": 17841,
"country": Indonesia
}
});
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N7TLZSRG');</script>
<!-- End Google Tag Manager -->



  </head>

  <body class="layout--single">

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N7TLZSRG"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          UnixBSDShell
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Posts by Category</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Posts by Year</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://unixwinbsd.site/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#freebsd" itemprop="item"><span itemprop="name">Freebsd</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">PFSense with Internal DNS - Setup Remote Unbound DNS Resolver For LAN Network</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/pscustomobject.jpg" alt="UnixBSDShell's Blog" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">UnixBSDShell's Blog</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>unixwinbsd.site is an online learning platform that provides online tutorials and videos about unix, FreeBSD, OpenBSD and Linux. Not only that, unixwinbsd.site also presents a variety of topics, including software development, programming, web design, and more. This blog provides various online tutorials and videos for beginners and experienced professionals. This blog also provides a Q&amp;A forum for users to ask questions and get help from other members.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Moscow, Russia</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/unixwinbsd/unixwinbsd.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://github.com/unixwinbsd/unixwinbsd.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">DevOps Notes</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/iwan-setiawan-943659164/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/unixwinbsd/unixwinbsd.github.io" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:iwanse1212@yandex.com">
            <meta itemprop="email" content="iwanse1212@yandex.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="PFSense with Internal DNS - Setup Remote Unbound DNS Resolver For LAN Network">
    <meta itemprop="description" content="To carry out its duties, the DNS server requires a client program called a resolver to connect each user’s computer to the DNS server. The DNS resolver searches the host address in the HOSTS file">
    <meta itemprop="datePublished" content="2025-07-26T15:32:21+03:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">PFSense with Internal DNS - Setup Remote Unbound DNS Resolver For LAN Network
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#1-system-specifications">1. System specifications</a></li>
  <li><a href="#2-setup-dns-server-settings">2. Setup DNS Server Settings</a></li>
  <li><a href="#3-setup-dns-resolver-unbound">3. Setup DNS Resolver (Unbound)</a></li>
  <li><a href="#4-test-dns-resolver">4. Test DNS Resolver</a></li>
  <li><a href="#5-firewall-redirect-to-dns-resolver">5. Firewall Redirect to DNS Resolver</a></li>
  <li><a href="#6-setup-dns-resolver-over-tls">6. Setup DNS Resolver Over TLS</a></li>
</ul>

            </nav>
          </aside>
        
        <p>Before we study the contents of this article further, it’s a good idea to know how DNS works. You need to understand that the DNS manager consists of 3 components, namely:</p>

<ul>
  <li>DNS resolver: is a client which is the user’s computer, the party that makes DNS requests from an application program.</li>
  <li>Recursive DNS server: is the party that performs searches via DNS based on the resolver’s request, then provides answers to the resolver.</li>
  <li>Authoritative DNS server: the party that provides responses after recursive searches. The response can be an answer or a delegation to another DNS server.</li>
</ul>

<p>To carry out its duties, the DNS server requires a client program called a resolver to connect each user’s computer to the DNS server. The DNS resolver searches the host address in the HOSTS file. If the host address you are looking for has been found and provided, then the process is complete. The DNS resolver searches the cache data that the resolver has created to store the results of previous requests. If there is, then it is stored in the data cache then the results are given and finished.</p>

<p>The DNS resolver searches the first DNS server address specified by the user. The DNS server is assigned to look for domain names in its cache. If the domain name searched by the DNS server is not found, then the search is carried out by looking at the database files (zones) owned by the server. If it is still not found, a search is carried out by contacting another DNS server that is still related to the server in question. If it has been found, it is stored in cache and the results are given to the client (via web browser).</p>

<p>Then next, namely DHCP, Dynamic Host Configuration Protocol (DHCP) is a service that allows devices to distribute/assign IP addresses automatically to hosts on a network. How it works, the DHCP Server will respond to requests sent by the DHCP Client. Apart from IP addresses, DHCP is also able to distribute netmask information, default gateway, DNS and NTP server configuration and many more custom options (depending on whether the DHCP client can support it).</p>

<p><img src="https://raw.githubusercontent.com/unixwinbsd/unixshellbsd.github.io/refs/heads/master/Image/17PFSense%20with%20Internal%20DNS%20-%20Setup%20Remote%20Unbound%20DNS%20Resolver%20For%20LAN%20Network.jpg" alt="PFSense with Internal DNS - Setup Remote Unbound DNS Resolver For LAN Network" /></p>

<h2 id="1-system-specifications">1. System specifications</h2>

<ul>
  <li>PFSense Version: PFSense 2.7.2-RELEASE (amd64), built on Wed Dec 6 20:10:00 UTC 2023</li>
  <li>Ethernet Card 1: nfe0 (WAN)</li>
  <li>Ethernet Card 2: rl0 (LAN)</li>
  <li>IP nfe0: 192.168.5.2 (WAN)</li>
  <li>IP rl0: 192.168.1.1 (LAN)</li>
  <li>CPU Type:
    <ul>
      <li>Intel(R) Core(TM)2 Duo CPU E8400 @ 3.00GHz</li>
      <li>Current: 2670 MHz, Max: 3003 MHz</li>
      <li>2 CPUs: 1 package(s) x 2 core(s)</li>
      <li>AES-NI CPU Crypto: No</li>
      <li>QAT Crypto: No</li>
    </ul>
  </li>
</ul>

<h2 id="2-setup-dns-server-settings">2. Setup DNS Server Settings</h2>

<p>To activate DNS Resolver, the first thing you have to do is set the <strong>DNS Server Settings</strong> section. This setting is very important, because it relates to the DNS IP that will be used by PFSense. To start setting up this section, click the <code class="language-plaintext highlighter-rouge">System -&gt;&gt; General Setup</code> menu. To make it clearer, look at the image below.</p>

<p><img src="https://raw.githubusercontent.com/unixwinbsd/unixshellbsd.github.io/refs/heads/master/Image/17menu%20system%20general%20setup.png" alt="menu system general setup" /></p>

<p><img src="https://raw.githubusercontent.com/unixwinbsd/unixshellbsd.github.io/refs/heads/master/Image/18-type%20the%20domain%20name%20and%20hostname.jpg" alt="type the domain name and hostname" /></p>

<p>IP 192.168.1.1 is your PFSense LAN IP and we will make it the DNS server IP. On the DNS Resolution Behavior menu, select “Use remote DNS Servers, ignore local DNS”. By default, PFSense will use the local DNS service with IP 127.0.0.1. This option will change the default DNS IP to your PFSense LAN IP.</p>

<h2 id="3-setup-dns-resolver-unbound">3. Setup DNS Resolver (Unbound)</h2>

<p>After that we continue by configuring the DNS Resolver (Unbound). To activate DNS Resolver, click the <code class="language-plaintext highlighter-rouge">Service -&gt;&gt; DNS Resolver</code>. Look at the image below.</p>

<p><img src="https://raw.githubusercontent.com/unixwinbsd/unixshellbsd.github.io/refs/heads/master/Image/19setup%20dns%20resolver.jpg" alt="setup dns resolver" /></p>

<p>Then you check the <code class="language-plaintext highlighter-rouge">Enable DNS resolver</code> option. For other settings, you can follow the following image guide.</p>

<p><img src="https://raw.githubusercontent.com/unixwinbsd/unixshellbsd.github.io/refs/heads/master/Image/19enable%20dns%20resolver.jpg" alt="enable dns resolver" /></p>

<p><img src="https://raw.githubusercontent.com/unixwinbsd/unixshellbsd.github.io/refs/heads/master/Image/19menu%20custom%20option.jpg" alt="menu custome option" /></p>

<p>The most important part of DNS Resolver settings is in the “Custom options” option. In this option you type the following script.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Script "Custom options" DNS Resolver
forward-zone:
name: "."
forward-ssl-upstream: yes
forward-addr: 1.1.1.1@853
forward-addr: 1.0.0.1@853
forward-addr: 8.8.8.8@853
</code></pre></div></div>
<p>Your final step is to click the blue <code class="language-plaintext highlighter-rouge">"Save"</code> icon and the <code class="language-plaintext highlighter-rouge">"Apply Changes"</code> menu at the top. To make it easier for you, you can just leave the other options as default. Let the system manage it automatically.</p>

<h2 id="4-test-dns-resolver">4. Test DNS Resolver</h2>

<p>In this section we will test the DNS Resolver that you have configured above. This test aims to ensure whether the DNS Resolver is running or not. The way to do the test is to open the <code class="language-plaintext highlighter-rouge">Diagnostics -&gt;&gt; Command Prompt</code> menu as shown in the image below.</p>

<p><img src="/img/1how-to-test-DNS-resolver.jpg" alt="how to test DNS resolver" /></p>

<p>In the “Execute Shell Command” option, type the script <strong>dig yahoo.com</strong> as in the example in the following image.</p>

<p><img src="https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/images/1command_to_test_dns_resolver.jpg" alt="command to test dns resolver" /></p>

<p>What you need to pay attention to is that the server must point to your PFSense LAN IP, namely 192.168.1.1. If the test results are like the picture above. You can be sure that your PFSense DNS Resolver is running normally. Next, you must reset DNS to DNS IP 192.168.1.1.</p>

<h2 id="5-firewall-redirect-to-dns-resolver">5. Firewall Redirect to DNS Resolver</h2>

<p>This section is only a summary of the contents of this article. After you have successfully run the DNS Resolver on PFSense, so that all clients connecting to the PFSense server use the DNS IP 192.168.1.1, we do a redirect on the Firewall. To do this, click the <code class="language-plaintext highlighter-rouge">Firewall -&gt;&gt; NAT -&gt;&gt; Fort Port Forward -&gt;&gt; Add</code>  menu. Look at the image below.</p>

<p><img src="/img/create-nat-pfsese.png" alt="create NAT on PFSEnese" /></p>

<p><img src="/img/create-port-forward.png" alt="create port forward" /></p>

<p><img src="https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/images/2nat_port_forward.jpg" alt="NAT Port Forward" /></p>

<p>Another option, you just make the default (don’t change it). When finished, you can see the results of creating the NAT Firewall Rules above in <code class="language-plaintext highlighter-rouge">Firewall -&gt;&gt; Rules</code>.</p>

<p><img src="https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/images/2create_firewall_rule.jpg" alt="create firewall rules" /></p>

<h2 id="6-setup-dns-resolver-over-tls">6. Setup DNS Resolver Over TLS</h2>

<p>In this section we will improve your PFSense DNS Resolver security system with OpenSSL TLS. With DNS over TLS configured in the DNS Resolver system, it will make it difficult for naughty hands to infiltrate your PFSense system.</p>

<p>To enable DNS Over TLS, you must enable SSH in PFSense. In this article, we will not discuss SSH in PFSesne, so we will just open SSH. If you use Ubuntu open Remmina and if you use Windows open the Putty application. In this article we use Remmina to remote the PFSesne server.</p>

<p><img src="/img/3menu-shel-pfsense.jpg" alt="Menu Shell PFSense" /></p>

<p>Then you type option number 8 to enter the Shell Remmina menu.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[2.7.2-RELEASE][root@nspfSense.unixwinbsd.site]/root: cd /var/unbound
[2.7.2-RELEASE][root@nspfSense.unixwinbsd.site]/var/unbound: fetch ftp://FTP.INTERNIC.NET/domain/named.cache -o /var/unbound/root.hints
</code></pre></div></div>

<p>After that, we create a TLS certificate with OpenSSL. Follow the script below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[2.7.2-RELEASE][root@nspfSense.unixwinbsd.site]/var/unbound: openssl genrsa -des3 -out myCA.key 2048
[2.7.2-RELEASE][root@nspfSense.unixwinbsd.site]/var/unbound: openssl req -x509 -new -nodes -key myCA.key -sha256 -days 1825 -out myCA.pem
[2.7.2-RELEASE][root@nspfSense.unixwinbsd.site]/var/unbound: openssl req -new -newkey rsa:2048 -nodes -keyout mydomain.key -out mydomain.csr
[2.7.2-RELEASE][root@nspfSense.unixwinbsd.site]/var/unbound: openssl x509 -req -in mydomain.csr -CA myCA.pem -CAkey myCA.key -CAcreateserial -out mydomain.pem -days 1825 -sha256
</code></pre></div></div>

<p>The next step, you enter the TLS script into the DNS Resolver configuration, as shown below.</p>

<p><img src="https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/images/display_custom_option_pfsense.jpg" alt="display custom option pfsense" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root-hints: "/var/unbound/root.hints"

tls-service-key: "/var/unbound/mydomain.key"
tls-service-pem: "/var/unbound/mydomain.pem"
tls-port: 853

forward-zone:
name: "."
forward-ssl-upstream: yes
forward-addr: 1.1.1.1@853
forward-addr: 1.0.0.1@853
forward-addr: 8.8.8.8@853
</code></pre></div></div>

<p>Test and see the results, you will notice on the computer screen whether your PFSense DNS Resolver server is running properly.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[2.7.2-RELEASE][root@nspfSense.unixwinbsd.site]/var/unbound: dig google.com

; &lt;&lt;&gt;&gt; DiG 9.18.19 &lt;&lt;&gt;&gt; google.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 8176
;; flags: qr rd ra; QUERY: 1, ANSWER: 6, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1432
;; QUESTION SECTION:
;google.com.			IN	A

;; ANSWER SECTION:
google.com.		265	IN	A	142.251.12.139
google.com.		265	IN	A	142.251.12.101
google.com.		265	IN	A	142.251.12.138
google.com.		265	IN	A	142.251.12.100
google.com.		265	IN	A	142.251.12.113
google.com.		265	IN	A	142.251.12.102

;; Query time: 419 msec
;; SERVER: 192.168.1.1#53(192.168.1.1) (UDP)
;; WHEN: Fri Apr 26 00:31:30 UTC 2024
;; MSG SIZE  rcvd: 135
</code></pre></div></div>

<p>If the server shows the IP 192.168.1.1 as in blue above, it means your DNS Resolver is running normally.</p>

<p>You can also test via a Windows computer. Configure your computer’s IP address to DHCP mode (do not use static IP). Make sure the DNS IP address read is IP 192.168.1.1.</p>

<p>If everything is according to the test instructions, now you have a DNS Resolver that is capable of storing DNS addresses. If a client connects to your PFSense and requests a DNS address, it will be served directly by your PFSense, thereby increasing your client’s internet speed.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#dnsserver" class="page__taxonomy-item" rel="tag">DNSServer</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#freebsd" class="page__taxonomy-item" rel="tag">FreeBSD</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2025-07-26T15:32:21+03:00">July 26, 2025</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=iwanset96143401&text=PFSense+with+Internal+DNS+-+Setup+Remote+Unbound+DNS+Resolver+For+LAN+Network%20https%3A%2F%2Funixwinbsd.site%2Ffreebsd%2Fpfsense-with-internal-dns-unbound%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funixwinbsd.site%2Ffreebsd%2Fpfsense-with-internal-dns-unbound%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funixwinbsd.site%2Ffreebsd%2Fpfsense-with-internal-dns-unbound%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/freebsd/implementing-python-modules-unbound-dns-on-freebsd/" class="pagination--pager" title="Implementing Python Modules for Unbound on FreeBSD Servers
">Previous</a>
    
    
      <a href="/freebsd/installation-and-configuration-doge-coin-freebsd/" class="pagination--pager" title="How to Install and Configure DOGE Coin on FreeBSD
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/freebsd/use-pfsense-pfBlockerNG-dnsbl-block-ads-malware/" rel="permalink">Use PFSense with pfBlockerNG DNSBL to Block Ads, Malware, Ransomware, and Web Tracking
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">By adding the pfBlockerNG package to your PFSense Router, you’ve blocked ads and also been able to block web tracking, ransomware, and malware. When you acti...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/freebsd/installation-java-development-kit-on-freebsd/" rel="permalink">Installing and Using the Java Development Kit on FreeBSD
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Redmine is open source software or application that uses the Ruby On Rails Framework. Redmine is a project management or project tracking application which r...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/freebsd/how-to-install-webmin-on-freebsd-machine/" rel="permalink">How to Install Webmin on a FreeBSD System
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Webmin is a web-based system administration tool for Unix-like servers, and a service with approximately 1,000,000 annual installations worldwide
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/freebsd/configuration-radicale-caldav-cardavv-server-freebsd/" rel="permalink">How to Configure FreeBSD with Radicale CalDAV CardDAV Server
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Radicale is run with the help of the Apache or NGINX web server, so it can be operated either as a standalone package using its internal http/https server or...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/unixwinbsd/unixwinbsd.github.io" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/catanesi/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn Profile</a></li>
        
      
        
          <li><a href="https://github.com/unixwinbsd/unixwinbsd.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 UnixBSDShell Blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "https://unixwinbsd.site/freebsd/pfsense-with-internal-dns-unbound/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/freebsd/pfsense-with-internal-dns-unbound"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://UnixBSDShell.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  







  </body>
</html>
