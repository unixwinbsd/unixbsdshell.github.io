---
title: Use PFSense with pfBlockerNG DNSBL to Block Ads, Malware, Ransomware, and Web Tracking
date: "2025-09-23 08:57:03 +0100"
updated: "2025-10-01 07:39:26 +0100"
id: use-pfsense-pfBlockerNG-dnsbl-block-ads-malware
lang: en
author: Iwan Setiawan
categories: Networking
tags: Router
background: https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/1_enable_insterface.png
toc: true
comments: true
published: true
excerpt: By adding the pfBlockerNG package to your PFSense Router, you've blocked ads and also been able to block web tracking, ransomware, and malware. When you activate pfBlockerNG, you immediately gain additional network security and privacy, as your entire PFSense system is protected by pfBlockerNG with the help of the DNSBL (Domain Name System-based Blackhole List) feature
keywords: pfsense, router, pfblockerng, dnsl, block, ads, malware, ransomware, web, tracking, firewall
---

pfBlockerNG has been around since 2018 and is a free and open-source distributed package. Since its inception, pfBlockerNG DNSBL has been built specifically for the PFSense Router software. With the pfBlockerNG DNSBL feature, PFSense is capable of blocking ads, blocking harmful content such as gambling and alcohol, and other noteworthy features, including pfBlockerNG's geo-blocking capabilities with the help of MaxMid.

By adding the pfBlockerNG package to your PFSense Router, you've blocked ads and also been able to block web tracking, ransomware, and malware. When you activate pfBlockerNG, you immediately gain additional network security and privacy, as your entire PFSense system is protected by pfBlockerNG with the help of the DNSBL (Domain Name System-based Blackhole List) feature.

The pfBlockerNG package can also block the internet from specific IP addresses. You can select IP addresses from specific countries or regions that you want to block. This can be beneficial because IP address restrictions make it harder for hackers to infiltrate your system.

In this article, we'll explain how to use DNSBL from the pfBlockerNG package to remove ads and block malware and spamware. In this article, we'll use PFSense version 2.7.2-RELEASE (amd64).

<br/>
<img alt="enable insterface pfsense" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/1_enable_insterface.png' | relative_url }}">
<br/>

## 1. Installing the pfBlockerNG DNSBL package

Before installing pfBlockerNG, make sure you have enabled the Unbound DNS server (DNS Resolver). If not, enable the DNS resolver first. You can read the previous article on how to enable the Unbound DNS server in PFSense.

<br/>
<img alt="enable python module" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/2_enable_Python-Module.png' | relative_url }}">
<br/>

However, to set up pfBlockerNG, you'll need to enable the Python package in DNS Resolver. See the image below for instructions on enabling the Python package in DNS Resolver.

<br/>
<img alt="pfblockerng setup" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/3_pfblockerng-setup.png' | relative_url }}">
<br/>

To install the `pfBlockerNG` DNSBL package, first click System -> Package Manager -> Available Packages, then locate the pfBlockerNG package and click the green Install button. Wait for the installation process to complete.

Then, proceed to configure pfBlockerNG by clicking Firewall -> pfBlockerNG. The first installation will show you the "Wizard" menu, as shown below.

<br/>
<img alt="pfblockerng ip component configuration" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/4_pfblockerNG-IP.png' | relative_url }}">
<br/>

Click the `"Next"` button to continue until the image below appears.

<br/>
<img alt="dnsbl webserver configuration" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/5-dnsbl-webserver-configuration.png' | relative_url }}">
<br/>

## 2. General Settings pfBlockerNG DNSBL

After the installation process is complete, we continue with the general settings of pfBlockerNG, to do this, click Firewall ->> pfBlockerNG ->> General.

<br/>
<img alt="menu general setting pfsense" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/6_menu-general-setup-pfsense.png' | relative_url }}">
<br/>

After that, click the "IP" option. You can leave the other settings as default. To complete the "MaxMind GeoIP configuration" field, you must register MaxMind GeoIP. Get your Account ID and License key at "https://www.maxmind.com/en/geolite2/signup".

<br/>
<img alt="firewall pfblockerng ip" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/7_firewall-fblockerng-ip.png' | relative_url }}">
<br/>

<img alt="maxmind geoip configuration" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/8-maxmind-geoip.png' | relative_url }}">
<br/>

## 3. Enable DNSBL
   
In this section we will set how to activate DNSBL. click Firewall ->> pfBlockerNG ->> DNSBL. Then you fill in each column according to the guide below.

### 3.1. DNSBL

DNSBL: Check
DNSBL Mode: Unbound python mode
Wildcard Blocking (TLD): Check
Python Control: Uncheck
DNS Reply Logging: Check
DNSBL Blocking: Check
HSTS mode: Check
TLD Allow: Uncheck
IDN Blocking: Uncheck
Regex Blocking: Uncheck
CNAME Validation: Check
no AAAA: Uncheck
Python Group Policy: Uncheck

### 3.2. DNSBL Webserver Configuration

Virtual IP Address: 10.10.10.1
IPv6 DNSBL: Uncheck
DNSBL VIP Type: IP Alias
Web Server Interface: Localhost
DNSBL Event Logging: Uncheck

### 3.3. DNSBL Configuration

Permit Firewall RulesEnable: Uncheck
Global Logging/Blocking Mode: No Global mode
Blocked Webpage: dnsbl_default.php
Resolver cache: Check

After that, you click Firewall ->> pfBlockerNG ->> DNSBLDNSBL ->> Category. To block porn sites or adult sites.

<br/>
<img alt="dnsbl category" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/9-DNSBL-Category.png' | relative_url }}">
<br/>

<img alt="maxmind ut1" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/10-maxmind-UT1.png' | relative_url }}">
<br/>

## 4. Enable IPv4 Blocking

In the pfBlockerNG package, by default PFSense enables PRI1 decoys. The feed is a publicly available block list that the pfBlockerNG package is configured to synchronize regularly. To see a list of enabled IPv4 feeds, click to Firewall ->> pfBlockerNG -> IP ->> IPv4.

<br/>
<img alt="pfblockerng ip4" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/11-pfblockerng-IP4.png' | relative_url }}">
<br/>

After that enable additional IPv4 feeds in your pfBlockerNG package. This aims to avoid false positives because the PRI1 bait has quite wide coverage, it is likely that the bait will miss the real threat. To enable IPv4 feeds, click Firewall ->> pfBlockerNG ->> Feeds.

<br/>
<img alt="pfblockerng feeds" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/12-pfblockerng-FEEDS.jpg' | relative_url }}">
<br/>

<img alt="pfblockerng pr2 pr3" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/13-pr2-pr3.jpg' | relative_url }}">
<br/>

So the results from the IP4 Feed will look like the image below.

<br/>
<img alt="pfblockerng ip4 summary" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/14-pfblockerngIP4.png' | relative_url }}">
<br/>

## 5. Enable MaxMind GeoIP

One of the main features of pfBlockerNG is `GeoIP from MaxMind Inc`. This feature is used to limit internet access to certain countries or regions. To activate the GeoIP feature, click Firewall ->> pfBlockerNG ->> IP ->> GeoIP.

<br/>
<img alt="geoip summary" width="99%" class="lazyload" style="display: block; margin: auto;" src="{{ 'https://gitlab.com/unixbsdshell/unixbsdshell.gitlab.io/-/raw/main/img/15-GeoIP-Summary.png' | relative_url }}">
<br/>

In the image above, we only block African countries and Proxy and Satellite networks.

Adding pfBlockerNG to your PFSense router is a smart move. You can help prevent children or adults from using the internet for good purposes. You're actually helping protect them from bad things.